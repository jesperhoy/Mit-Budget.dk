(()=>{var pt=Object.freeze,ct=Object.defineProperty;var Ne=(t,e,n)=>e in t?ct(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var g=(t,e,n)=>(Ne(t,typeof e!="symbol"?e+"":e,n),n),nt=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var c=(t,e,n)=>(nt(t,e,"read from private field"),n?n.call(t):e.get(t)),m=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},w=(t,e,n,l)=>(nt(t,e,"write to private field"),l?l.call(t,n):e.set(t,n),n);var $=(t,e,n)=>(nt(t,e,"access private method"),n);var r=(t,e)=>pt(ct(t,"raw",{value:pt(e||t.slice())}));var L,I,R,rt,z,it,bt,S=class{constructor(){m(this,R);m(this,z);g(this,"required",!1);g(this,"validity","");g(this,"value",0);g(this,"onChange");m(this,L,!1);m(this,I,void 0)}load(){$(this,R,rt).call(this)}render(){return html(bt||(bt=r(['\n    <input type="text"\n      .value=',"\n      @input="," \n      @change="," \n      #validity=",'\n    style="text-align:right;max-width:125px"\n    class="form-control"\n    required=',"/>"])),c(this,I),e=>$(this,z,it).call(this,e,!1),e=>$(this,z,it).call(this,e,!0),c(this,L)?"Ugyldig v\xE6rdi":this.validity,this.required)}};L=new WeakMap,I=new WeakMap,R=new WeakSet,rt=function(){w(this,I,this.value===0?"":M(this.value))},z=new WeakSet,it=function(e,n){w(this,I,e.target.value);let l=c(this,I).split(".").join("").split(",").join(".").split(" ").join(""),d=l===""?0:Math.round(parseFloat(l)*100)/100;if(isNaN(d)){n&&w(this,L,!0);return}w(this,L,!1),this.value=d,this.onChange&&this.onChange(d),n&&$(this,R,rt).call(this)};var gt,mt,ft,vt,kt,yt,wt,$t,Mt,xt,Ct,Bt,Dt,It;function v(t){switch(t){case"add":return html(gt||(gt=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M256 112v288M400 256H112" /></svg>'])));case"check":return html(mt||(mt=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M416 128L192 384l-96-96" /></svg>'])));case"edit":return html(ft||(ft=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M384 224v184a40 40 0 01-40 40H104a40 40 0 01-40-40V168a40 40 0 0140-40h167.48" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /><path d="M459.94 53.25a16.06 16.06 0 00-23.22-.56L424.35 65a8 8 0 000 11.31l11.34 11.32a8 8 0 0011.34 0l12.06-12c6.1-6.09 6.67-16.01.85-22.38zM399.34 90L218.82 270.2a9 9 0 00-2.31 3.93L208.16 299a3.91 3.91 0 004.86 4.86l24.85-8.35a9 9 0 003.93-2.31L422 112.66a9 9 0 000-12.66l-9.95-10a9 9 0 00-12.71 0z" fill="currentColor" /></svg>'])));case"trash":return html(vt||(vt=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M112 112l20 320c.95 18.49 14.4 32 32 32h184c17.67 0 30.87-13.51 32-32l20-320" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="32" d="M80 112h352" /><path d="M192 112V72h0a23.93 23.93 0 0124-24h80a23.93 23.93 0 0124 24h0v40M256 176v224M184 176l8 224M328 176l-8 224" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /></svg>'])));case"download":return html(kt||(kt=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M320 336h76c55 0 100-21.21 100-75.6s-53-73.47-96-75.6C391.11 99.74 329 48 256 48c-69 0-113.44 45.79-128 91.2-60 5.7-112 35.88-112 98.4S70 336 136 336h56M192 400.1l64 63.9 64-63.9M256 224v224.03" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /></svg>'])));case"upload":return html(yt||(yt=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M320 367.79h76c55 0 100-29.21 100-83.6s-53-81.47-96-83.6c-8.89-85.06-71-136.8-144-136.8-69 0-113.44 45.79-128 91.2-60 5.7-112 43.88-112 106.4s54 106.4 120 106.4h56" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M320 255.79l-64-64-64 64M256 448.21V207.79" /></svg>'])));case"save":return html(wt||(wt=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M380.93 57.37A32 32 0 00358.3 48H94.22A46.21 46.21 0 0048 94.22v323.56A46.21 46.21 0 0094.22 464h323.56A46.36 46.36 0 00464 417.78V153.7a32 32 0 00-9.37-22.63zM256 416a64 64 0 1164-64 63.92 63.92 0 01-64 64zm48-224H112a16 16 0 01-16-16v-64a16 16 0 0116-16h192a16 16 0 0116 16v64a16 16 0 01-16 16z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /></svg>'])));case"open":return html($t||($t=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M64 192v-72a40 40 0 0140-40h75.89a40 40 0 0122.19 6.72l27.84 18.56a40 40 0 0022.19 6.72H408a40 40 0 0140 40v40" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /><path d="M479.9 226.55L463.68 392a40 40 0 01-39.93 40H88.25a40 40 0 01-39.93-40L32.1 226.55A32 32 0 0164 192h384.1a32 32 0 0131.8 34.55z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /></svg>'])));case"new":return html(Mt||(Mt=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M416 221.25V416a48 48 0 01-48 48H144a48 48 0 01-48-48V96a48 48 0 0148-48h98.75a32 32 0 0122.62 9.37l141.26 141.26a32 32 0 019.37 22.62z" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32" /><path d="M256 56v120a32 32 0 0032 32h120" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /></svg>'])));case"share":return html(xt||(xt=r(["<svg class=\"icon\" xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><circle cx='128' cy='256' r='48' fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' /><circle cx='384' cy='112' r='48' fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' /><circle cx='384' cy='400' r='48' fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' /><path fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' d='M169.83 279.53l172.34 96.94M342.17 135.53l-172.34 96.94' /></svg>"])));case"copy":return html(Ct||(Ct=r(["<svg class=\"icon\" xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><rect x='128' y='128' width='336' height='336' rx='57' ry='57' fill='none' stroke='currentColor' stroke-linejoin='round' stroke-width='32' /><path d='M383.5 128l.5-24a56.16 56.16 0 00-56-56H112a64.19 64.19 0 00-64 64v216a56.16 56.16 0 0056 56h24' fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' /></svg>"])));case"warning":return html(Bt||(Bt=r(["<svg class=\"icon\" xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><path d='M85.57 446.25h340.86a32 32 0 0028.17-47.17L284.18 82.58c-12.09-22.44-44.27-22.44-56.36 0L57.4 399.08a32 32 0 0028.17 47.17z' fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' /><path d='M250.26 195.39l5.74 122 5.73-121.95a5.74 5.74 0 00-5.79-6h0a5.74 5.74 0 00-5.68 5.95z' fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' /><path d='M256 397.25a20 20 0 1120-20 20 20 0 01-20 20z' /></svg>"])));case"info":return html(Dt||(Dt=r(["<svg class=\"icon\" xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><path d='M248 64C146.39 64 64 146.39 64 248s82.39 184 184 184 184-82.39 184-184S349.61 64 248 64z' fill='none' stroke='currentColor' stroke-miterlimit='10' stroke-width='32' /><path fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' d='M220 220h32v116' /><path fill='none' stroke='currentColor' stroke-linecap='round' stroke-miterlimit='10' stroke-width='32' d='M208 340h88' /><path d='M248 130a26 26 0 1026 26 26 26 0 00-26-26z' /></svg>"])));default:return html(It||(It=r(['<div class="icon">Icon name \'',"' not found</div>"])),t)}}var x,C,A,jt,St,B=class{constructor(){m(this,A);g(this,"title","");g(this,"size","md");g(this,"contentBody");g(this,"contentFooter");g(this,"onSubmit");m(this,x,null);m(this,C,!1)}Show(){c(this,C)||(w(this,C,!0),c(this,x)&&c(this,x).show())}Hide(){c(this,C)&&(w(this,C,!1),c(this,x)&&c(this,x).hide())}get value(){return c(this,C)}set value(e){e?this.Show():this.Hide()}render(){return html(St||(St=r(['<div class="modal fade" tabindex="-1" #ref=','>\n  <div class="modal-dialog modal-dialog-centered','">\n    <div class="modal-content">\n      <form @submit|prevent=','>\n        <div class="modal-header">\n          <h5 class="modal-title">','</h5>\n          <button type="button" class="btn-close" @click=',' aria-label="Close"></button>\n        </div>\n        <div class="modal-body">','</div>\n        <div class="modal-footer">',"</div>\n      </form>\n    </div>\n  </div>\n</div>"])),e=>$(this,A,jt).call(this,e),this.size==="md"?"":" modal-"+this.size,()=>{this.onSubmit&&this.onSubmit()},this.title,()=>this.Hide(),this.contentBody,this.contentFooter)}};x=new WeakMap,C=new WeakMap,A=new WeakSet,jt=function(e){setTimeout(()=>{w(this,x,new bootstrap.Modal(e,{keyboard:!1,backdrop:"static"})),c(this,C)&&c(this,x).show()},5)};var H,O,J,Lt,Ft,G=class{constructor(e){m(this,J);g(this,"label",null);g(this,"checked",!1);g(this,"inline",!1);g(this,"onInput");m(this,H,"");m(this,O,void 0);w(this,O,e);for(let n=0;n<16;n++)w(this,H,c(this,H)+Math.floor(Math.random()*16).toString(16))}render(){return html(Ft||(Ft=r(['<div class="form-check','">\n    <input .checked=',"\n           @input=",'\n           class="form-check-input"\n           type=',"\n           id=",'>\n    <label class="form-check-label" for=',">","</label>\n  </div>"])),this.inline?" form-check-inline":"",this.checked,e=>$(this,J,Lt).call(this,e),c(this,O)?"radio":"checkbox",c(this,H),c(this,H),this.label)}};H=new WeakMap,O=new WeakMap,J=new WeakSet,Lt=function(e){this.checked=e.target.checked,this.onInput&&this.onInput(this.checked)};var j=class extends G{constructor(){super(!0)}},U=class extends G{constructor(){super(!1)}};var Ht=["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],E,Y,Ut,W,Jt,_,qt,Q,Yt,Et,Nt,Pt,Vt,Kt,Rt,zt,Ot,Tt,At,Gt,q=class{constructor(){m(this,Y);m(this,W);m(this,_);m(this,Q);m(this,E,void 0);g(this,"data");g(this,"onGem")}Show(){c(this,E).Show()}Hide(){c(this,E).Hide()}render(){return html(Gt||(Gt=r(["\n    ",""])),[B,{size:"lg",title:"Udgift / Indt\xE6gt",onSubmit:()=>this.onGem(),contentBody:$(this,_,qt).call(this),contentFooter:$(this,Q,Yt).call(this)},e=>w(this,E,e)])}};E=new WeakMap,Y=new WeakSet,Ut=function(){for(let e=0;e<12;e++)if(this.data.betalingsm\u00E5neder[e])return!0;return!1},W=new WeakSet,Jt=function(){for(let e=0;e<12;e++)if(this.data.varbel\u00F8b[e]!==0)return!0;return!1},_=new WeakSet,qt=function(){return this.data?html(Tt||(Tt=r(['\n  <table class="form" style="width:100%">\n    <tbody>\n      <tr>\n        <th>Type:</th>\n        <td class="pad">\n          ',"\n          &nbsp;\n          ","\n        </td>\n      </tr>\n      <tr>\n        <th>Beskrivelse:</th>\n        <td><input #bind|trim=",' type="text" class="form-control" required /></td>\n      </tr>\n      <!--<tr>\n  <th>Gruppe:</th>\n  <td><select class="form-select"></select></td>\n  </tr>-->\n      <tr>\n        <th>Budgett\xE9r med:</th>\n        <td class="pad">\n          ',"\n          &nbsp;\n          ","\n        </td>\n      </tr>\n      <tr>\n        <th>Bel\xF8b:</th>\n        <td>\n          ","\n        </td>\n      </tr>\n      ","\n      ",'\n      <tr>\n        <th>F\xF8rste gang:</th>\n        <td><input type="date" #bind=',' required class="form-control" /></td>\n      </tr>\n      <tr>\n        <th>Slutter:</th>\n        <td class=',">\n          ","\n          ","\n        </td>\n      </tr>\n    </tbody>\n  </table>"])),[j,{checked:this.data.udgift,onInput:()=>this.data.udgift=!0,inline:!0,label:"Udgift"}],[j,{checked:!this.data.udgift,onInput:()=>this.data.udgift=!1,inline:!0,label:"Indt\xE6gt"}],[this.data,"beskriv"],[j,{checked:!this.data.variabelt,onInput:()=>this.data.variabelt=!1,inline:!0,label:"Et fast bel\xF8b"}],[j,{checked:this.data.variabelt,onInput:()=>this.data.variabelt=!0,inline:!0,label:"Et variabelt bel\xF8b"}],this.data.variabelt?html(Pt||(Pt=r(["<table>\n            ","\n          </table>"])),[1,2,3,4].map(e=>html(Nt||(Nt=r(["<tr>\n              ","\n            </tr>"])),[1,2,3].map(n=>html(Et||(Et=r(['\n                <td style="padding:2px .5rem 2px 0;text-align:right">','</td>\n                <td _style="padding:2px ',' 2px 0">\n                  ',"\n                </td>"])),Ht[e*3+n-4],n<3?"2rem":"0",[S,{value:this.data.varbel\u00F8b[e*3+n-4],onChange:l=>this.data.varbel\u00F8b[e*3+n-4]=l,validity:e===1&&n===1&&!$(this,W,Jt).call(this)?"Anf\xF8r bel\xF8b for mindst en m\xE5ned":""}]))))):[S,{value:this.data.fastbel\u00F8b,onChange:e=>this.data.fastbel\u00F8b=e,required:!0}],this.data.variabelt?null:html(Vt||(Vt=r(["\n      <tr>\n        <th>Hyppighed:</th>\n        <td>\n          <select #bind|number=",'.hyppighed class="form-select">\n            <option value="1">Ugentlig</option>\n            <option value="2">Hver anden uge</option>\n            <option value="3">Hver tredje uge</option>\n            <option value="4">Hver fjerde uge</option>\n            <option value="5">To gange pr. m\xE5ned</option>\n            <option value="6">M\xE5nedlig</option>\n            <option value="7">Hver anden m\xE5ned</option>\n            <option value="8">Kvartalsvis</option>\n            <option value="9">Tre gange \xE5rligt</option>\n            <option value="10">Halv\xE5rligt</option>\n            <option value="11">\xC5rligt</option>\n            <option value="12">De anf\xF8rte m\xE5neder</option>\n          </select>\n        </td>\n      </tr>'])),this.data),!this.data.variabelt&&this.data.hyppighed===12?html(zt||(zt=r(["\n      <tr>\n        <th>Betalingsm\xE5neder:</th>\n        <td>\n          <table>\n            ","\n          </table>\n        </td>\n      </tr>"])),[1,2].map(e=>html(Rt||(Rt=r(["\n            <tr>\n              ","\n            </tr>"])),[1,2,3,4,5,6].map(n=>html(Kt||(Kt=r(['\n              <td style="padding: .5rem 1rem 0 0">\n                <label>\n                  <input type=checkbox #bind='," #validity="," />\n                  ","\n                </label>\n              </td>"])),[this.data.betalingsm\u00E5neder,e*6+n-7],e===1&&n===1&&!$(this,Y,Ut).call(this)?"V\xE6lg mindst en m\xE5ned":"",Ht[e*6+n-7]))))):null,[this.data,"start"],this.data.harslut?null:"pad",[U,{checked:this.data.harslut,onInput:e=>this.data.harslut=e,inline:!0}],this.data.harslut?html(Ot||(Ot=r(["\n          <input type=date #bind=",' required class="form-control d-inline-block"\n              #validity='," />\n          "])),[this.data,"slut"],this.data.start.length>0&&this.data.slut.length>0&&this.data.start>this.data.slut?"Kan ikke v\xE6re f\xF8r f\xF8rste betaling":""):null):null},Q=new WeakSet,Yt=function(){return html(At||(At=r(["\n    <button @click=",' type="button" class="btn btn-secondary">Annuller</button>\n    <button type="submit" class="btn btn-primary">'," Gem</button>"])),()=>this.Hide(),v("check"))};var f=null,o=null,P=0,V=null,lt="months",k=12,T=null,Ie,Se,je,Fe,ot,Pe=navigator.share!==void 0;function K(){return JSON.stringify(o)}function Ve(){return o.items.sort(function(t,e){let n=t.beskriv.toLowerCase(),l=e.beskriv.toLowerCase();return n<l?-1:n>l?1:0})}function st(){return new Date(parseInt(o.startm\u00E5ned.substr(0,4)),parseInt(o.startm\u00E5ned.substr(5,2))-1,1)}function Z(){T=K()}function N(t,e,n){let l=[],d=e-t+1;for(let b=0;b<d;b++)l.push(n(t+b));return l}function Le(){return{navn:"",startm\u00E5ned:new Date().getFullYear()+"-"+(new Date().getMonth()+101).toString().substr(1),startsaldo:0,items:[],nextid:1}}function M(t){let e=t.toFixed(2).replace(".",","),n=e.substr(e.length-3);for(e=e.substr(0,e.length-3);e.length>4||e.length===4&&e.charAt(0)!=="-";)n="."+e.substr(e.length-3)+n,e=e.substr(0,e.length-3);return e+n}var _t;function tt(t){return t<0?html(_t||(_t=r(['<span style="color:red">',"</span>"])),M(t)):M(t)}function Ke(t){let e=st(),n=e.getFullYear(),l=e.getMonth()+t;for(;l>11;)n+=1,l-=12;return["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"][l]+" "+n.toString().substr(2)}function at(t){if(t===0)P=0,V={id:0,udgift:!0,beskriv:"",variabelt:!1,fastbel\u00F8b:0,varbel\u00F8b:[0,0,0,0,0,0,0,0,0,0,0,0],hyppighed:6,betalingsm\u00E5neder:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],start:"",harslut:!1,slut:""};else{let e=o.items.find(n=>n.id===t);P=t,V=JSON.parse(JSON.stringify(e))}ot.Show()}function He(t){let e=o.items.findIndex(n=>n.id===t);e<0||o.items.splice(e,1)}function Re(){if(P===0)P=o.nextid++,V.id=P,o.items.push(V);else{let t=o.items.findIndex(e=>e.id===P);o.items[t]=V}ot.Hide()}function ze(t){return(t.getDate()+100).toString().substr(1)+"."+(t.getMonth()+101).toString().substr(1)+"."+t.getFullYear()}async function Oe(){if(!(f!=="nyt"&&K()===T)){if(f==="nyt"){let t=await fetch("/api/budget",{method:"POST",headers:{"Content-Type":"application/json"},body:K()});if(t.status!==201){alert("Unexpected response status code ("+t.status+") received");return}f=t.headers.get("Location").substr(1),document.location.hash=f,je.Show()}else{let t=await fetch("/api/budget/"+f,{method:"PUT",headers:{"Content-Type":"application/json"},body:K()});if(!t.ok){alert("Unexpected response (status code "+t.status+") received");return}}Z(),et.redraw()}}async function Te(){if(f==="nyt")return;let t=await fetch("/api/budget/"+f,{method:"DELETE"});if(t.status!==204){alert("Unexpected response status code ("+t.status+") received");return}f="nyt",document.location.hash="nyt",T="dummy",et.redraw(),Ie.Show()}function Ae(){navigator.share({title:"Mit-Budget.dk - "+o.navn,url:window.location.href})}function Ge(){o=Le(),Z(),f="nyt",document.location.hash="nyt",Se.Show()}function Ue(){o.navn+=" (kopi)",f="nyt",document.location.hash="nyt",Fe.Show()}async function Ee(){let t=window.location.hash,e=t.length<=1?null:t.substr(1);if(e===f||(document.getElementById("base").style.maxWidth=e===null?"960px":"",document.getElementById("intro").style.display=e===null?"block":"none",document.body.style.backgroundColor=e===null?"#ccc":"white",f=e,e===null))return;if(e==="nyt"){o=Le(),Z(),et.redraw();return}o=null;let n=await fetch("/api/budget/"+e);n.status===404?(alert("Det angive budget findes ikke!"),f=null,document.location.hash=""):n.status!==200?(alert("Unexpected response status code ("+n.status+") received"),f=null,document.location.hash=""):(o=await n.json(),Z()),et.redraw()}function Je(t,e,n){let l=Wt(t.start),d=l.getDate()===F(l.getFullYear(),l.getMonth()),b=t.harslut?Wt(t.slut):new Date(3e3,0,1),u=l.getDate(),h=[],i;if(t.variabelt){let a=e.getMonth(),p=e.getFullYear();for(i=d?new Date(p,a,F(p,a)):X(p,a,u);i<=b&&i<=n;)i>=l&&t.varbel\u00F8b[a]!==0&&h.push({itemid:t.id,dato:i,beskriv:t.beskriv,bel\u00F8b:t.udgift?-t.varbel\u00F8b[a]:t.varbel\u00F8b[a],udgift:t.udgift}),a+=1,a>11&&(a-=12,p+=1),i=d?new Date(p,a,F(p,a)):X(p,a,u)}else if(t.hyppighed<5){let a=7;for(t.hyppighed===2&&(a=14),t.hyppighed===3&&(a=21),t.hyppighed===4&&(a=28),i=l;i<=b&&i<=n;)i>=e&&h.push({itemid:t.id,dato:i,beskriv:t.beskriv,bel\u00F8b:t.udgift?-t.fastbel\u00F8b:t.fastbel\u00F8b,udgift:t.udgift}),i=new Date(i.getTime()+a*864e5)}else{let a=l.getFullYear(),p=l.getMonth(),y=1;for(t.hyppighed===6&&(y=1),t.hyppighed===7&&(y=2),t.hyppighed===8&&(y=3),t.hyppighed===9&&(y=4),t.hyppighed===10&&(y=6),t.hyppighed===11&&(y=12),t.hyppighed===12&&(y=1),i=d?new Date(a,p,F(a,p)):X(a,p,u);i<=b&&i<=n;)i>=e&&i>=l&&(t.hyppighed!==12||t.betalingsm\u00E5neder[p])&&h.push({itemid:t.id,dato:i,beskriv:t.beskriv,bel\u00F8b:t.udgift?-t.fastbel\u00F8b:t.fastbel\u00F8b,udgift:t.udgift}),t.hyppighed===5&&(i=new Date(i.getTime()+15*864e5),i>=e&&i<=n&&i>=l&&i<=b&&h.push({itemid:t.id,dato:i,beskriv:t.beskriv,bel\u00F8b:t.udgift?-t.fastbel\u00F8b:t.fastbel\u00F8b,udgift:t.udgift})),p+=y,p>11&&(p-=12,a+=1),i=d?new Date(a,p,F(a,p)):X(a,p,u)}return h}function qe(t,e,n,l){let d=[];l!==0&&d.push({itemid:0,dato:e,beskriv:"Start saldo",bel\u00F8b:l,udgift:!1});for(let u of t)d=d.concat(Je(u,e,n));d.sort(function(u,h){return u.dato<h.dato?-1:u.dato>h.dato?1:0});let b=0;for(let u of d)b+=u.bel\u00F8b,u.balance=b;return d}function F(t,e){return e!==1?[31,0,31,30,31,30,31,31,30,31,30,31][e]:t===2100?28:t%4===0?29:28}function Wt(t){return new Date(parseInt(t.substr(0,4)),parseInt(t.substr(5,2))-1,parseInt(t.substr(8,2)))}function X(t,e,n){let l=F(t,e);return n>l&&(n=l),new Date(t,e,n)}var Qt,Xt,Zt;function Ye(){return document.title="Mit-Budget.dk"+(!o||o.navn===""?"":" - "+o.navn),html(Zt||(Zt=r(["<div>\n    ","\n  </div>"])),f===null?html(Qt||(Qt=r([' \n      <a href="#nyt" class="btn btn-primary">'," Nyt budget</a>\n    "])),v("new")):o===null?html(Xt||(Xt=r(['\n      <div class="spinner-border text-primary" role="status">\n        <span class="visually-hidden">Loading...</span>\n      </div>\n    ']))):We())}var te,ee,ne,re,ie,le,oe;function We(){let t=K()!==T,e=st(),n=e.getFullYear(),l=e.getMonth()+k-1;for(;l>11;)n+=1,l-=12;let d=new Date(n,l,F(n,l)),b=qe(o.items,e,d,o.startsaldo),u=0,h=0;for(let i of b)i.itemid!==0&&(i.udgift?u-=i.bel\u00F8b:h+=i.bel\u00F8b);return u=u/k,h=h/k,html(oe||(oe=r(["<p>\n  <button @click="," disabled=",' type=button class="btn btn-primary">'," Gem i skyen</button>\n\n  ",'\n</p>\n\n<hr />\n\n<table class="form">\n  <tbody>\n    ','\n    <tr>\n      <th>Budget-navn:</th>\n      <td><input type="text" #bind|trim=','.navn required class="form-control" style="max-width:40rem" /></td>\n    </tr>\n    <tr>\n      <th>F\xF8rste m\xE5ned:</th>\n      <td><input type="month" #bind=','.startm\xE5ned required class="form-control" /></td>\n    </tr>\n    <tr>\n      <th>Startsaldo:</th>\n      <td>',"</td>\n    </tr>\n  </tbody>\n</table>\n\n<hr />\n\n","\n\n\n<p>\n  <button @click=",' type=button class="btn btn-primary">'," Tilf\xF8j udgift/indt\xE6gt</button>\n</p>\n\n","\n","\n","\n","\n",""])),Oe,!t||o.items.length===0,v("upload"),f!=="nyt"?html(ee||(ee=r(["\n    ","\n    <button @click|prevent=",' type=button class="btn btn-primary">'," Lav kopi</button>\n    <button @click|prevent=",' type=button class="btn btn-danger">'," Slet fra skyen</button>\n    <button @click=",' type=button class="btn btn-primary">'," Nyt budget</button>\n    "])),Pe?html(te||(te=r(["<button @click=",' type=button class="btn btn-primary">'," Del</button>"])),Ae,v("share")):null,Ue,v("copy"),Te,v("trash"),Ge,v("new")):null,f!=="nyt"||o.items.length>0?html(ie||(ie=r(["\n    <tr>\n      <th>Status:</th>\n      <td>\n        ","\n      </td>\n    </tr>"])),t?html(re||(re=r(['<div class="alert alert-warning d-inline-block p-1 m-0">'," \xC6ndringer ikke gemt</div>"])),v("warning")):html(ne||(ne=r(['<div class="alert alert-success d-inline-block p-1 m-0">'," Gemt i skyen</div>"])),v("check"))):null,o,o,[S,{value:o.startsaldo,onChange:i=>o.startsaldo=i}],o.items.length>0?html(le||(le=r(["\n  <p>\n    Visning: <select #bind=",' class="form-select d-inline-block w-auto">\n      <option value="months">M\xE5ned-skema</option>\n      <option value="ledger">Som kontoudtog</option>\n    </select>\n\n    &nbsp;&nbsp;&nbsp;Periode:\n    <select #bind|number=',' class="form-select d-inline-block w-auto">\n      <option value="12">12 m\xE5neder</option>\n      <option value="18">18 m\xE5neder</option>\n      <option value="24">24 m\xE5neder</option>\n      <option value="36">36 m\xE5neder</option>\n    </select>\n\n  </p>\n\n  ',"\n\n  <p>\n    <b>Gns. udgift pr. m\xE5ned:</b> ","<br />\n    <b>Gns. indt\xE6gt pr. m\xE5ned:</b> ","<br />\n    <b>Gns. r\xE5dighedsbel\xF8b m\xE5ned:</b> ","\n  </p>\n  <hr />\n\n  "])),[lt,i=>lt=i],[k,i=>k=i],lt==="months"?_e(b):Qe(b),M(u),M(h),tt(h-u)):null,()=>at(0),v("add"),[q,{data:V,onGem:Re},i=>ot=i],tn(),en(),Ze(),Xe())}var se,ae,de,ue,he,pe,ce,be,ge;function _e(t){var dt,ut;let e=st(),n=new Map,l=[],d=[],b=0,u=[],h=0,i=0,a=e.getFullYear()*12+e.getMonth(),p,y;for(let s=0;s<k;s++)l[s]=0,d[s]=0,u[s]=0;for(let s of t){for(y=s.dato.getFullYear()*12+s.dato.getMonth()-a,p=s.itemid+"."+y,n.set(p,((dt=n.get(p))!=null?dt:0)+s.bel\u00F8b),s.itemid!==0&&(l[y]=((ut=l[y])!=null?ut:0)+s.bel\u00F8b),s.itemid===0&&(h=s.bel\u00F8b);y>i;)d[i]=b,u[i]=h,h=d[i],i+=1;b=s.balance,s.balance<h&&(h=s.balance)}for(;k>i;)d[i]=b,u[i]=h,h=d[i],i+=1;return html(ge||(ge=r(['<table class="table" style="width:auto">\n  <tbody>\n    <tr>\n      <th colspan="3"></th>\n      ',"\n    </tr>\n    ",'\n    <tr>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td style="white-space:nowrap;font-weight:bold" colspan=','>N\xF8gletal</td>\n    </tr>\n    <tr>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td style="white-space:nowrap">Startsaldo</td>\n      <td style="text-align:right">',"</td>\n      ",'\n    </tr>\n    <tr>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td style="white-space:nowrap">R\xE5dighedsbel\xF8b</td>\n      ','\n    </tr>\n    <tr>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td style="white-space:nowrap">Ultimosaldo</td>\n      ','\n    </tr>\n    <tr>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td style="white-space:nowrap">Laveste saldo</td>\n      ',"\n    </tr>\n  </tbody>\n</table>"])),N(0,k-1,s=>html(se||(se=r(["<th>","</th>"])),Ke(s))),[1,2].map(s=>html(ue||(ue=r(['\n      <tr>\n        <td>&nbsp;</td>\n        <td>&nbsp;</td>\n        <td style="white-space:nowrap;font-weight:bold" colspan=',">","</td>\n      </tr>\n      ","\n    "])),k+1,s===1?"Udgifter":"Indt\xE6gter",Ve().filter(D=>D.udgift===(s===1)).map(D=>html(de||(de=r(['\n        <tr>\n          <td><a href="#" @click|prevent=',' class="link-primary">','</a></td>\n          <td><a href="#" @click|prevent=',' class="link-danger">','</a></td>\n          <td style="white-space:nowrap">',"</td>\n          ","\n        </tr>"])),()=>at(D.id),v("edit"),()=>He(D.id),v("trash"),D.beskriv,N(1,k,ht=>html(ae||(ae=r(['<td style="text-align:right">',"</td>"])),n.get(D.id+"."+(ht-1))===void 0?"":M(n.get(D.id+"."+(ht-1))))))))),k+1,M(o.startsaldo),N(2,k,s=>html(he||(he=r(["<td>&nbsp;</td>"])))),N(1,k,s=>html(pe||(pe=r(['<td style="text-align:right">',"</td>"])),M(l[s-1]))),N(1,k,s=>html(ce||(ce=r(['<td style="text-align:right">',"</td>"])),tt(d[s-1]))),N(1,k,s=>html(be||(be=r(['<td style="text-align:right">',"</td>"])),tt(u[s-1]))))}var me,fe,ve,ke;function Qe(t){return html(ke||(ke=r(['<table class="table" style="width:auto">\n  <tbody>\n    <tr>\n      <th colspan="2"></th>\n      <th style="text-align:left">Dato</th>\n      <th style="text-align:left">Beskrivelse</th>\n      <th style="text-align:right">Bel\xF8b</th>\n      <th style="text-align:right">Saldo</th>\n    </tr>\n    ',"\n  </tbody>\n</table>"])),t.map(e=>html(ve||(ve=r(["\n    <tr>\n      <td>","</td>\n      <td>","</td>\n      <td>","</td>\n      <td>",'</td>\n      <td style="text-align:right">','</td>\n      <td style="text-align:right">',"</td>\n    </tr>"])),e.itemid>0?html(me||(me=r(['<a href="#" @click|prevent=',' class="link-primary">',"</a>"])),()=>at(e.itemid),v("edit")):null,e.itemid>0?html(fe||(fe=r(['<a href="#" @click|prevent=',' class="link-danger">',"</a>"])),()=>He(e.itemid),v("trash")):null,ze(e.dato),e.beskriv,M(e.bel\u00F8b),tt(e.balance))))}var ye,we;function Xe(){return[B,{title:"Budget er slettet fra skyen",contentBody:html(ye||(ye=r(['<p>Dit budget eksisterer lige nu kun i din browser, og er helt v\xE6k n\xE5r du lukker browser-vinduet/fanen.</p>\n    <p>Hvis du slettede ved en fejl, kan du gemme budgettet igen ved at klikke p\xE5 "Gem i skyen" knappen.\n    Budgettet vil s\xE5 blive gemt igen p\xE5 en ny adresse.</p>']))),contentFooter:html(we||(we=r(['<button type="button" class="btn btn-primary" data-bs-dismiss="modal" style="min-width:6rem">OK</button>'])))},t=>Ie=t]}var $e,Me;function Ze(){return[B,{title:"Lav Kopi",contentBody:html($e||($e=r(["<p>Du arbejder nu i en kopi af dit tidligere budget.</p>\n    <p>Hvis du ikke fik gemt adressen p\xE5 dit originale budget, kan du g\xE5 tilbage til det med din browsers tilbage-knap.</p>"]))),contentFooter:html(Me||(Me=r(['<button type="button" class="btn btn-primary" data-bs-dismiss="modal" style="min-width:6rem">OK</button>'])))},t=>Fe=t]}var xe,Ce;function tn(){return[B,{title:"Nyt budget",contentBody:html(xe||(xe=r(["<p>Du arbejder nu i et nyt budget.</p>\n      <p>Hvis du ikke fik gemt adressen p\xE5 dit tidligere budget, kan du g\xE5 tilbage til det med din browsers tilbage-knap.</p>"]))),contentFooter:html(Ce||(Ce=r(['<button type="button" class="btn btn-primary" data-bs-dismiss="modal" style="min-width:6rem">OK</button>'])))},t=>Se=t]}var Be,De;function en(){return[B,{title:"Dit budget er nu gemt i skyen",contentBody:html(Be||(Be=r(['\n    <p>\n      Du kan \xE5bne dette budget igen senere ved at lave et bogm\xE6rke i din browser nu, og s\xE5 \xE5bne bogm\xE6rket senere.<br />\n      Eller du kan kopiere adressen (fra browserens adresse-felt) og gemme den et sikkert sted.\n    </p>\n    <p>\n      Du kan ogs\xE5 dele dit budget med andre (f.eks. bank-r\xE5dgiver eller revisor) ved at sende dem adressen.\n      Bem\xE6rk dog at dem du deler med ogs\xE5 vil kunne \xE6ndre og/eller slette budgettet.\n      Overvej derfor at sende dem en kopi (brug "Lav kopi" funktionen, gem, og send dem s\xE5 den nye adresse).\n    </p>']))),contentFooter:html(De||(De=r(['<button type="button" class="btn btn-primary" data-bs-dismiss="modal" style="min-width:6rem">OK</button>'])))},t=>je=t]}var et=Katla.app("#app",Ye);window.addEventListener("beforeunload",function(t){f!==null&&T!==K()&&(t.returnValue="Dine \xE6ndringer er ikke gemt. Vil du stadig lukke browser-vinduet/tabben?")});window.addEventListener("hashchange",Ee,!1);Ee();})();
