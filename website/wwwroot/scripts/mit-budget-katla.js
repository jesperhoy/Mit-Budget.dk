(()=>{var ct=Object.freeze,bt=Object.defineProperty;var Pe=(t,e,n)=>e in t?bt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var m=(t,e,n)=>(Pe(t,typeof e!="symbol"?e+"":e,n),n),it=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var u=(t,e,n)=>(it(t,e,"read from private field"),n?n.call(t):e.get(t)),b=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},v=(t,e,n,l)=>(it(t,e,"write to private field"),l?l.call(t,n):e.set(t,n),n);var y=(t,e,n)=>(it(t,e,"access private method"),n);var r=(t,e)=>ct(bt(t,"raw",{value:ct(e||t.slice())}));var H,S,x,E,G,O,lt,gt,j=class{constructor(){b(this,E);b(this,O);m(this,"required",!1);m(this,"validity","");m(this,"onChange");b(this,H,!1);b(this,S,void 0);b(this,x,0)}get value(){return u(this,x)}set value(e){e!==u(this,x)&&(v(this,x,e),y(this,E,G).call(this))}load(){y(this,E,G).call(this)}render(){return html(gt||(gt=r(['\n    <input type="text"\n      .value=',"\n      @input="," \n      @change="," \n      #validity=",'\n    style="text-align:right;max-width:125px"\n    class="form-control"\n    required=',"/>"])),u(this,S),e=>y(this,O,lt).call(this,e,!1),e=>y(this,O,lt).call(this,e,!0),u(this,H)?"Ugyldig v\xE6rdi":this.validity,this.required)}};H=new WeakMap,S=new WeakMap,x=new WeakMap,E=new WeakSet,G=function(){v(this,S,u(this,x)===0?"":M(u(this,x)))},O=new WeakSet,lt=function(e,n){v(this,S,e.target.value);let l=u(this,S).split(".").join("").split(",").join(".").split(" ").join(""),d=l===""?0:Math.round(parseFloat(l)*100)/100;if(isNaN(d)){n&&v(this,H,!0);return}v(this,H,!1),v(this,x,d),this.onChange&&this.onChange(d),n&&y(this,E,G).call(this)};var mt,ft,vt,kt,yt,wt,$t,Mt,xt,Ct,Bt,Dt,It,St;function k(t){switch(t){case"add":return html(mt||(mt=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M256 112v288M400 256H112" /></svg>'])));case"check":return html(ft||(ft=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M416 128L192 384l-96-96" /></svg>'])));case"edit":return html(vt||(vt=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M384 224v184a40 40 0 01-40 40H104a40 40 0 01-40-40V168a40 40 0 0140-40h167.48" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /><path d="M459.94 53.25a16.06 16.06 0 00-23.22-.56L424.35 65a8 8 0 000 11.31l11.34 11.32a8 8 0 0011.34 0l12.06-12c6.1-6.09 6.67-16.01.85-22.38zM399.34 90L218.82 270.2a9 9 0 00-2.31 3.93L208.16 299a3.91 3.91 0 004.86 4.86l24.85-8.35a9 9 0 003.93-2.31L422 112.66a9 9 0 000-12.66l-9.95-10a9 9 0 00-12.71 0z" fill="currentColor" /></svg>'])));case"trash":return html(kt||(kt=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M112 112l20 320c.95 18.49 14.4 32 32 32h184c17.67 0 30.87-13.51 32-32l20-320" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="32" d="M80 112h352" /><path d="M192 112V72h0a23.93 23.93 0 0124-24h80a23.93 23.93 0 0124 24h0v40M256 176v224M184 176l8 224M328 176l-8 224" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /></svg>'])));case"download":return html(yt||(yt=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M320 336h76c55 0 100-21.21 100-75.6s-53-73.47-96-75.6C391.11 99.74 329 48 256 48c-69 0-113.44 45.79-128 91.2-60 5.7-112 35.88-112 98.4S70 336 136 336h56M192 400.1l64 63.9 64-63.9M256 224v224.03" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /></svg>'])));case"upload":return html(wt||(wt=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M320 367.79h76c55 0 100-29.21 100-83.6s-53-81.47-96-83.6c-8.89-85.06-71-136.8-144-136.8-69 0-113.44 45.79-128 91.2-60 5.7-112 43.88-112 106.4s54 106.4 120 106.4h56" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M320 255.79l-64-64-64 64M256 448.21V207.79" /></svg>'])));case"save":return html($t||($t=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M380.93 57.37A32 32 0 00358.3 48H94.22A46.21 46.21 0 0048 94.22v323.56A46.21 46.21 0 0094.22 464h323.56A46.36 46.36 0 00464 417.78V153.7a32 32 0 00-9.37-22.63zM256 416a64 64 0 1164-64 63.92 63.92 0 01-64 64zm48-224H112a16 16 0 01-16-16v-64a16 16 0 0116-16h192a16 16 0 0116 16v64a16 16 0 01-16 16z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /></svg>'])));case"open":return html(Mt||(Mt=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M64 192v-72a40 40 0 0140-40h75.89a40 40 0 0122.19 6.72l27.84 18.56a40 40 0 0022.19 6.72H408a40 40 0 0140 40v40" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /><path d="M479.9 226.55L463.68 392a40 40 0 01-39.93 40H88.25a40 40 0 01-39.93-40L32.1 226.55A32 32 0 0164 192h384.1a32 32 0 0131.8 34.55z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /></svg>'])));case"new":return html(xt||(xt=r(['<svg class="icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M416 221.25V416a48 48 0 01-48 48H144a48 48 0 01-48-48V96a48 48 0 0148-48h98.75a32 32 0 0122.62 9.37l141.26 141.26a32 32 0 019.37 22.62z" fill="none" stroke="currentColor" stroke-linejoin="round" stroke-width="32" /><path d="M256 56v120a32 32 0 0032 32h120" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" /></svg>'])));case"share":return html(Ct||(Ct=r(["<svg class=\"icon\" xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><circle cx='128' cy='256' r='48' fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' /><circle cx='384' cy='112' r='48' fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' /><circle cx='384' cy='400' r='48' fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' /><path fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' d='M169.83 279.53l172.34 96.94M342.17 135.53l-172.34 96.94' /></svg>"])));case"copy":return html(Bt||(Bt=r(["<svg class=\"icon\" xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><rect x='128' y='128' width='336' height='336' rx='57' ry='57' fill='none' stroke='currentColor' stroke-linejoin='round' stroke-width='32' /><path d='M383.5 128l.5-24a56.16 56.16 0 00-56-56H112a64.19 64.19 0 00-64 64v216a56.16 56.16 0 0056 56h24' fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' /></svg>"])));case"warning":return html(Dt||(Dt=r(["<svg class=\"icon\" xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><path d='M85.57 446.25h340.86a32 32 0 0028.17-47.17L284.18 82.58c-12.09-22.44-44.27-22.44-56.36 0L57.4 399.08a32 32 0 0028.17 47.17z' fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' /><path d='M250.26 195.39l5.74 122 5.73-121.95a5.74 5.74 0 00-5.79-6h0a5.74 5.74 0 00-5.68 5.95z' fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' /><path d='M256 397.25a20 20 0 1120-20 20 20 0 01-20 20z' /></svg>"])));case"info":return html(It||(It=r(["<svg class=\"icon\" xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'><path d='M248 64C146.39 64 64 146.39 64 248s82.39 184 184 184 184-82.39 184-184S349.61 64 248 64z' fill='none' stroke='currentColor' stroke-miterlimit='10' stroke-width='32' /><path fill='none' stroke='currentColor' stroke-linecap='round' stroke-linejoin='round' stroke-width='32' d='M220 220h32v116' /><path fill='none' stroke='currentColor' stroke-linecap='round' stroke-miterlimit='10' stroke-width='32' d='M208 340h88' /><path d='M248 130a26 26 0 1026 26 26 26 0 00-26-26z' /></svg>"])));default:return html(St||(St=r(['<div class="icon">Icon name \'',"' not found</div>"])),t)}}var C,B,U,Ft,jt,D=class{constructor(){b(this,U);m(this,"title","");m(this,"size","md");m(this,"contentBody");m(this,"contentFooter");m(this,"onSubmit");b(this,C,null);b(this,B,!1)}Show(){u(this,B)||(v(this,B,!0),u(this,C)&&u(this,C).show())}Hide(){u(this,B)&&(v(this,B,!1),u(this,C)&&u(this,C).hide())}get value(){return u(this,B)}set value(e){e?this.Show():this.Hide()}render(){return html(jt||(jt=r(['<div class="modal fade" tabindex="-1" #ref=','>\n  <div class="modal-dialog modal-dialog-centered','">\n    <div class="modal-content">\n      <form @submit|prevent=','>\n        <div class="modal-header">\n          <h5 class="modal-title">','</h5>\n          <button type="button" class="btn-close" @click=',' aria-label="Close"></button>\n        </div>\n        <div class="modal-body">','</div>\n        <div class="modal-footer">',"</div>\n      </form>\n    </div>\n  </div>\n</div>"])),e=>y(this,U,Ft).call(this,e),this.size==="md"?"":" modal-"+this.size,()=>{this.onSubmit&&this.onSubmit()},this.title,()=>this.Hide(),this.contentBody,this.contentFooter)}};C=new WeakMap,B=new WeakMap,U=new WeakSet,Ft=function(e){setTimeout(()=>{v(this,C,new bootstrap.Modal(e,{keyboard:!1,backdrop:"static"})),u(this,B)&&u(this,C).show()},5)};var N,T,Y,Ht,Lt,J=class{constructor(e){b(this,Y);m(this,"label",null);m(this,"checked",!1);m(this,"inline",!1);m(this,"onInput");b(this,N,"");b(this,T,void 0);v(this,T,e);for(let n=0;n<16;n++)v(this,N,u(this,N)+Math.floor(Math.random()*16).toString(16))}render(){return html(Lt||(Lt=r(['<div class="form-check','">\n    <input .checked=',"\n           @input=",'\n           class="form-check-input"\n           type=',"\n           id=",'>\n    <label class="form-check-label" for=',">","</label>\n  </div>"])),this.inline?" form-check-inline":"",this.checked,e=>y(this,Y,Ht).call(this,e),u(this,T)?"radio":"checkbox",u(this,N),u(this,N),this.label)}};N=new WeakMap,T=new WeakMap,Y=new WeakSet,Ht=function(e){this.checked=e.target.checked,this.onInput&&this.onInput(this.checked)};var F=class extends J{constructor(){super(!0)}},q=class extends J{constructor(){super(!1)}};var Et=["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"],P,_,Jt,Q,qt,X,Yt,Z,Wt,Nt,Pt,Vt,Kt,Rt,zt,Ot,Tt,At,Gt,Ut,W=class{constructor(){b(this,_);b(this,Q);b(this,X);b(this,Z);b(this,P,void 0);m(this,"data");m(this,"onGem")}Show(){u(this,P).Show()}Hide(){u(this,P).Hide()}render(){return html(Ut||(Ut=r(["\n    ",""])),[D,{size:"lg",title:"Udgift / Indt\xE6gt",onSubmit:()=>this.onGem(),contentBody:y(this,X,Yt).call(this),contentFooter:y(this,Z,Wt).call(this)},e=>v(this,P,e)])}};P=new WeakMap,_=new WeakSet,Jt=function(){for(let e=0;e<12;e++)if(this.data.betalingsm\u00E5neder[e])return!0;return!1},Q=new WeakSet,qt=function(){for(let e=0;e<12;e++)if(this.data.varbel\u00F8b[e]!==0)return!0;return!1},X=new WeakSet,Yt=function(){return this.data?html(At||(At=r(['\n  <table class="form" style="width:100%">\n    <tbody>\n      <tr>\n        <th>Type:</th>\n        <td class="pad">\n          ',"\n          &nbsp;\n          ","\n        </td>\n      </tr>\n      <tr>\n        <th>Beskrivelse:</th>\n        <td><input #bind|trim=",' type="text" class="form-control" required /></td>\n      </tr>\n      <!--<tr>\n  <th>Gruppe:</th>\n  <td><select class="form-select"></select></td>\n  </tr>-->\n      <tr>\n        <th>Budgett\xE9r med:</th>\n        <td class="pad">\n          ',"\n          &nbsp;\n          ","\n        </td>\n      </tr>\n      <tr>\n        <th>Bel\xF8b:</th>\n        <td>\n          ","\n        </td>\n      </tr>\n      ","\n      ",'\n      <tr>\n        <th>F\xF8rste gang:</th>\n        <td><input type="date" #bind=',' required class="form-control" /></td>\n      </tr>\n      <tr>\n        <th>Slutter:</th>\n        <td class=',">\n          ","\n          ","\n        </td>\n      </tr>\n    </tbody>\n  </table>"])),[F,{checked:this.data.udgift,onInput:()=>this.data.udgift=!0,inline:!0,label:"Udgift"}],[F,{checked:!this.data.udgift,onInput:()=>this.data.udgift=!1,inline:!0,label:"Indt\xE6gt"}],[this.data,"beskriv"],[F,{checked:!this.data.variabelt,onInput:()=>this.data.variabelt=!1,inline:!0,label:"Et fast bel\xF8b"}],[F,{checked:this.data.variabelt,onInput:()=>this.data.variabelt=!0,inline:!0,label:"Et variabelt bel\xF8b"}],this.data.variabelt?html(Vt||(Vt=r(["<table>\n            ","\n          </table>"])),[1,2,3,4].map(e=>html(Pt||(Pt=r(["<tr>\n              ","\n            </tr>"])),[1,2,3].map(n=>html(Nt||(Nt=r(['\n                <td style="padding:2px .5rem 2px 0;text-align:right">','</td>\n                <td _style="padding:2px ',' 2px 0">\n                  ',"\n                </td>"])),Et[e*3+n-4],n<3?"2rem":"0",[j,{value:this.data.varbel\u00F8b[e*3+n-4],onChange:l=>this.data.varbel\u00F8b[e*3+n-4]=l,validity:e===1&&n===1&&!y(this,Q,qt).call(this)?"Anf\xF8r bel\xF8b for mindst en m\xE5ned":""}]))))):[j,{value:this.data.fastbel\u00F8b,onChange:e=>this.data.fastbel\u00F8b=e,required:!0}],this.data.variabelt?null:html(Kt||(Kt=r(["\n      <tr>\n        <th>Hyppighed:</th>\n        <td>\n          <select #bind|number=",'.hyppighed class="form-select">\n            <option value="1">Ugentlig</option>\n            <option value="2">Hver anden uge</option>\n            <option value="3">Hver tredje uge</option>\n            <option value="4">Hver fjerde uge</option>\n            <option value="5">To gange pr. m\xE5ned</option>\n            <option value="6">M\xE5nedlig</option>\n            <option value="7">Hver anden m\xE5ned</option>\n            <option value="8">Kvartalsvis</option>\n            <option value="9">Tre gange \xE5rligt</option>\n            <option value="10">Halv\xE5rligt</option>\n            <option value="11">\xC5rligt</option>\n            <option value="12">De anf\xF8rte m\xE5neder</option>\n          </select>\n        </td>\n      </tr>'])),this.data),!this.data.variabelt&&this.data.hyppighed===12?html(Ot||(Ot=r(["\n      <tr>\n        <th>Betalingsm\xE5neder:</th>\n        <td>\n          <table>\n            ","\n          </table>\n        </td>\n      </tr>"])),[1,2].map(e=>html(zt||(zt=r(["\n            <tr>\n              ","\n            </tr>"])),[1,2,3,4,5,6].map(n=>html(Rt||(Rt=r(['\n              <td style="padding: .5rem 1rem 0 0">\n                <label>\n                  <input type=checkbox #bind='," #validity="," />\n                  ","\n                </label>\n              </td>"])),[this.data.betalingsm\u00E5neder,e*6+n-7],e===1&&n===1&&!y(this,_,Jt).call(this)?"V\xE6lg mindst en m\xE5ned":"",Et[e*6+n-7]))))):null,[this.data,"start"],this.data.harslut?null:"pad",[q,{checked:this.data.harslut,onInput:e=>this.data.harslut=e,inline:!0}],this.data.harslut?html(Tt||(Tt=r(["\n          <input type=date #bind=",' required class="form-control d-inline-block"\n              #validity='," />\n          "])),[this.data,"slut"],this.data.start.length>0&&this.data.slut.length>0&&this.data.start>this.data.slut?"Kan ikke v\xE6re f\xF8r f\xF8rste betaling":""):null):null},Z=new WeakSet,Wt=function(){return html(Gt||(Gt=r(["\n    <button @click=",' type="button" class="btn btn-secondary">Annuller</button>\n    <button type="submit" class="btn btn-primary">'," Gem</button>"])),()=>this.Hide(),k("check"))};var f=null,o=null,K=0,R=null,ot="months",w=12,A=null,Se,je,Fe,Le,st,Ve=navigator.share!==void 0;function z(){return JSON.stringify(o)}function Ke(){return o.items.sort(function(t,e){let n=t.beskriv.toLowerCase(),l=e.beskriv.toLowerCase();return n<l?-1:n>l?1:0})}function at(){return new Date(parseInt(o.startm\u00E5ned.substr(0,4)),parseInt(o.startm\u00E5ned.substr(5,2))-1,1)}function et(){A=z()}function V(t,e,n){let l=[],d=e-t+1;for(let g=0;g<d;g++)l.push(n(t+g));return l}function He(){return{navn:"",startm\u00E5ned:new Date().getFullYear()+"-"+(new Date().getMonth()+101).toString().substr(1),startsaldo:0,items:[],nextid:1}}function M(t){let e=t.toFixed(2).replace(".",","),n=e.substr(e.length-3);for(e=e.substr(0,e.length-3);e.length>4||e.length===4&&e.charAt(0)!=="-";)n="."+e.substr(e.length-3)+n,e=e.substr(0,e.length-3);return e+n}var Qt;function nt(t){return t<0?html(Qt||(Qt=r(['<span style="color:red">',"</span>"])),M(t)):M(t)}function Re(t){let e=at(),n=e.getFullYear(),l=e.getMonth()+t;for(;l>11;)n+=1,l-=12;return["Jan","Feb","Mar","Apr","Maj","Jun","Jul","Aug","Sep","Okt","Nov","Dec"][l]+" "+n.toString().substr(2)}function dt(t){if(t===0)K=0,R={id:0,udgift:!0,beskriv:"",variabelt:!1,fastbel\u00F8b:0,varbel\u00F8b:[0,0,0,0,0,0,0,0,0,0,0,0],hyppighed:6,betalingsm\u00E5neder:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],start:"",harslut:!1,slut:""};else{let e=o.items.find(n=>n.id===t);K=t,R=JSON.parse(JSON.stringify(e))}st.Show()}function Ee(t){let e=o.items.findIndex(n=>n.id===t);e<0||o.items.splice(e,1)}function ze(){if(K===0)K=o.nextid++,R.id=K,o.items.push(R);else{let t=o.items.findIndex(e=>e.id===K);o.items[t]=R}st.Hide()}function Oe(t){return(t.getDate()+100).toString().substr(1)+"."+(t.getMonth()+101).toString().substr(1)+"."+t.getFullYear()}async function Te(){if(!(f!=="nyt"&&z()===A)){if(f==="nyt"){let t=await fetch("/api/budget",{method:"POST",headers:{"Content-Type":"application/json"},body:z()});if(t.status!==201){alert("Unexpected response status code ("+t.status+") received");return}f=t.headers.get("Location").substr(1),document.location.hash=f,Fe.Show()}else{let t=await fetch("/api/budget/"+f,{method:"PUT",headers:{"Content-Type":"application/json"},body:z()});if(!t.ok){alert("Unexpected response (status code "+t.status+") received");return}}et(),rt.redraw()}}async function Ae(){if(f==="nyt")return;let t=await fetch("/api/budget/"+f,{method:"DELETE"});if(t.status!==204){alert("Unexpected response status code ("+t.status+") received");return}f="nyt",document.location.hash="nyt",A="dummy",rt.redraw(),Se.Show()}function Ge(){navigator.share({title:"Mit-Budget.dk - "+o.navn,url:window.location.href})}function Ue(){o=He(),et(),f="nyt",document.location.hash="nyt",je.Show()}function Je(){o.navn+=" (kopi)",f="nyt",document.location.hash="nyt",Le.Show()}async function Ne(){let t=window.location.hash,e=t.length<=1?null:t.substr(1);if(e===f||(document.getElementById("base").style.maxWidth=e===null?"960px":"",document.getElementById("intro").style.display=e===null?"block":"none",document.body.style.backgroundColor=e===null?"#ccc":"white",f=e,e===null))return;if(e==="nyt"){o=He(),et(),rt.redraw();return}o=null;let n=await fetch("/api/budget/"+e);n.status===404?(alert("Det angive budget findes ikke!"),f=null,document.location.hash=""):n.status!==200?(alert("Unexpected response status code ("+n.status+") received"),f=null,document.location.hash=""):(o=await n.json(),et()),rt.redraw()}function qe(t,e,n){let l=_t(t.start),d=l.getDate()===L(l.getFullYear(),l.getMonth()),g=t.harslut?_t(t.slut):new Date(3e3,0,1),h=l.getDate(),p=[],i;if(t.variabelt){let a=e.getMonth(),c=e.getFullYear();for(i=d?new Date(c,a,L(c,a)):tt(c,a,h);i<=g&&i<=n;)i>=l&&t.varbel\u00F8b[a]!==0&&p.push({itemid:t.id,dato:i,beskriv:t.beskriv,bel\u00F8b:t.udgift?-t.varbel\u00F8b[a]:t.varbel\u00F8b[a],udgift:t.udgift}),a+=1,a>11&&(a-=12,c+=1),i=d?new Date(c,a,L(c,a)):tt(c,a,h)}else if(t.hyppighed<5){let a=7;for(t.hyppighed===2&&(a=14),t.hyppighed===3&&(a=21),t.hyppighed===4&&(a=28),i=l;i<=g&&i<=n;)i>=e&&p.push({itemid:t.id,dato:i,beskriv:t.beskriv,bel\u00F8b:t.udgift?-t.fastbel\u00F8b:t.fastbel\u00F8b,udgift:t.udgift}),i=new Date(i.getTime()+a*864e5)}else{let a=l.getFullYear(),c=l.getMonth(),$=1;for(t.hyppighed===6&&($=1),t.hyppighed===7&&($=2),t.hyppighed===8&&($=3),t.hyppighed===9&&($=4),t.hyppighed===10&&($=6),t.hyppighed===11&&($=12),t.hyppighed===12&&($=1),i=d?new Date(a,c,L(a,c)):tt(a,c,h);i<=g&&i<=n;)i>=e&&i>=l&&(t.hyppighed!==12||t.betalingsm\u00E5neder[c])&&p.push({itemid:t.id,dato:i,beskriv:t.beskriv,bel\u00F8b:t.udgift?-t.fastbel\u00F8b:t.fastbel\u00F8b,udgift:t.udgift}),t.hyppighed===5&&(i=new Date(i.getTime()+15*864e5),i>=e&&i<=n&&i>=l&&i<=g&&p.push({itemid:t.id,dato:i,beskriv:t.beskriv,bel\u00F8b:t.udgift?-t.fastbel\u00F8b:t.fastbel\u00F8b,udgift:t.udgift})),c+=$,c>11&&(c-=12,a+=1),i=d?new Date(a,c,L(a,c)):tt(a,c,h)}return p}function Ye(t,e,n,l){let d=[];l!==0&&d.push({itemid:0,dato:e,beskriv:"Start saldo",bel\u00F8b:l,udgift:!1});for(let h of t)d=d.concat(qe(h,e,n));d.sort(function(h,p){return h.dato<p.dato?-1:h.dato>p.dato?1:0});let g=0;for(let h of d)g+=h.bel\u00F8b,h.balance=g;return d}function L(t,e){return e!==1?[31,0,31,30,31,30,31,31,30,31,30,31][e]:t===2100?28:t%4===0?29:28}function _t(t){return new Date(parseInt(t.substr(0,4)),parseInt(t.substr(5,2))-1,parseInt(t.substr(8,2)))}function tt(t,e,n){let l=L(t,e);return n>l&&(n=l),new Date(t,e,n)}var Xt,Zt,te;function We(){return document.title="Mit-Budget.dk"+(!o||o.navn===""?"":" - "+o.navn),html(te||(te=r(["<div>\n    ","\n  </div>"])),f===null?html(Xt||(Xt=r([' \n      <a href="#nyt" class="btn btn-primary">'," Nyt budget</a>\n    "])),k("new")):o===null?html(Zt||(Zt=r(['\n      <div class="spinner-border text-primary" role="status">\n        <span class="visually-hidden">Loading...</span>\n      </div>\n    ']))):_e())}var ee,ne,re,ie,le,oe,se;function _e(){let t=z()!==A,e=at(),n=e.getFullYear(),l=e.getMonth()+w-1;for(;l>11;)n+=1,l-=12;let d=new Date(n,l,L(n,l)),g=Ye(o.items,e,d,o.startsaldo),h=0,p=0;for(let i of g)i.itemid!==0&&(i.udgift?h-=i.bel\u00F8b:p+=i.bel\u00F8b);return h=h/w,p=p/w,html(se||(se=r(["<p>\n  <button @click="," disabled=",' type=button class="btn btn-primary">'," Gem i skyen</button>\n\n  ",'\n</p>\n\n<hr />\n\n<table class="form">\n  <tbody>\n    ','\n    <tr>\n      <th>Budget-navn:</th>\n      <td><input type="text" #bind|trim=','.navn required class="form-control" style="max-width:40rem" /></td>\n    </tr>\n    <tr>\n      <th>F\xF8rste m\xE5ned:</th>\n      <td><input type="month" #bind=','.startm\xE5ned required class="form-control" /></td>\n    </tr>\n    <tr>\n      <th>Startsaldo:</th>\n      <td>',"</td>\n    </tr>\n  </tbody>\n</table>\n\n<hr />\n\n","\n\n\n<p>\n  <button @click=",' type=button class="btn btn-primary">'," Tilf\xF8j udgift/indt\xE6gt</button>\n</p>\n\n","\n","\n","\n","\n",""])),Te,!t||o.items.length===0,k("upload"),f!=="nyt"?html(ne||(ne=r(["\n    ","\n    <button @click|prevent=",' type=button class="btn btn-primary">'," Lav kopi</button>\n    <button @click|prevent=",' type=button class="btn btn-danger">'," Slet fra skyen</button>\n    <button @click=",' type=button class="btn btn-primary">'," Nyt budget</button>\n    "])),Ve?html(ee||(ee=r(["<button @click=",' type=button class="btn btn-primary">'," Del</button>"])),Ge,k("share")):null,Je,k("copy"),Ae,k("trash"),Ue,k("new")):null,f!=="nyt"||o.items.length>0?html(le||(le=r(["\n    <tr>\n      <th>Status:</th>\n      <td>\n        ","\n      </td>\n    </tr>"])),t?html(ie||(ie=r(['<div class="alert alert-warning d-inline-block p-1 m-0">'," \xC6ndringer ikke gemt</div>"])),k("warning")):html(re||(re=r(['<div class="alert alert-success d-inline-block p-1 m-0">'," Gemt i skyen</div>"])),k("check"))):null,o,o,[j,{value:o.startsaldo,onChange:i=>o.startsaldo=i}],o.items.length>0?html(oe||(oe=r(["\n  <p>\n    Visning: <select #bind=",' class="form-select d-inline-block w-auto">\n      <option value="months">M\xE5ned-skema</option>\n      <option value="ledger">Som kontoudtog</option>\n    </select>\n\n    &nbsp;&nbsp;&nbsp;Periode:\n    <select #bind|number=',' class="form-select d-inline-block w-auto">\n      <option value="12">12 m\xE5neder</option>\n      <option value="18">18 m\xE5neder</option>\n      <option value="24">24 m\xE5neder</option>\n      <option value="36">36 m\xE5neder</option>\n    </select>\n\n  </p>\n\n  ',"\n\n  <p>\n    <b>Gns. udgift pr. m\xE5ned:</b> ","<br />\n    <b>Gns. indt\xE6gt pr. m\xE5ned:</b> ","<br />\n    <b>Gns. r\xE5dighedsbel\xF8b m\xE5ned:</b> ","\n  </p>\n  <hr />\n\n  "])),[ot,i=>ot=i],[w,i=>w=i],ot==="months"?Qe(g):Xe(g),M(h),M(p),nt(p-h)):null,()=>dt(0),k("add"),[W,{data:R,onGem:ze},i=>st=i],en(),nn(),tn(),Ze())}var ae,de,ue,he,pe,ce,be,ge,me;function Qe(t){var ut,ht;let e=at(),n=new Map,l=[],d=[],g=0,h=[],p=0,i=0,a=e.getFullYear()*12+e.getMonth(),c,$;for(let s=0;s<w;s++)l[s]=0,d[s]=0,h[s]=0;for(let s of t){for($=s.dato.getFullYear()*12+s.dato.getMonth()-a,c=s.itemid+"."+$,n.set(c,((ut=n.get(c))!=null?ut:0)+s.bel\u00F8b),s.itemid!==0&&(l[$]=((ht=l[$])!=null?ht:0)+s.bel\u00F8b),s.itemid===0&&(p=s.bel\u00F8b);$>i;)d[i]=g,h[i]=p,p=d[i],i+=1;g=s.balance,s.balance<p&&(p=s.balance)}for(;w>i;)d[i]=g,h[i]=p,p=d[i],i+=1;return html(me||(me=r(['<table class="table" style="width:auto">\n  <tbody>\n    <tr>\n      <th colspan="3"></th>\n      ',"\n    </tr>\n    ",'\n    <tr>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td style="white-space:nowrap;font-weight:bold" colspan=','>N\xF8gletal</td>\n    </tr>\n    <tr>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td style="white-space:nowrap">Startsaldo</td>\n      <td style="text-align:right">',"</td>\n      ",'\n    </tr>\n    <tr>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td style="white-space:nowrap">R\xE5dighedsbel\xF8b</td>\n      ','\n    </tr>\n    <tr>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td style="white-space:nowrap">Ultimosaldo</td>\n      ','\n    </tr>\n    <tr>\n      <td>&nbsp;</td>\n      <td>&nbsp;</td>\n      <td style="white-space:nowrap">Laveste saldo</td>\n      ',"\n    </tr>\n  </tbody>\n</table>"])),V(0,w-1,s=>html(ae||(ae=r(["<th>","</th>"])),Re(s))),[1,2].map(s=>html(he||(he=r(['\n      <tr>\n        <td>&nbsp;</td>\n        <td>&nbsp;</td>\n        <td style="white-space:nowrap;font-weight:bold" colspan=',">","</td>\n      </tr>\n      ","\n    "])),w+1,s===1?"Udgifter":"Indt\xE6gter",Ke().filter(I=>I.udgift===(s===1)).map(I=>html(ue||(ue=r(['\n        <tr>\n          <td><a href="#" @click|prevent=',' class="link-primary">','</a></td>\n          <td><a href="#" @click|prevent=',' class="link-danger">','</a></td>\n          <td style="white-space:nowrap">',"</td>\n          ","\n        </tr>"])),()=>dt(I.id),k("edit"),()=>Ee(I.id),k("trash"),I.beskriv,V(1,w,pt=>html(de||(de=r(['<td style="text-align:right">',"</td>"])),n.get(I.id+"."+(pt-1))===void 0?"":M(n.get(I.id+"."+(pt-1))))))))),w+1,M(o.startsaldo),V(2,w,s=>html(pe||(pe=r(["<td>&nbsp;</td>"])))),V(1,w,s=>html(ce||(ce=r(['<td style="text-align:right">',"</td>"])),M(l[s-1]))),V(1,w,s=>html(be||(be=r(['<td style="text-align:right">',"</td>"])),nt(d[s-1]))),V(1,w,s=>html(ge||(ge=r(['<td style="text-align:right">',"</td>"])),nt(h[s-1]))))}var fe,ve,ke,ye;function Xe(t){return html(ye||(ye=r(['<table class="table" style="width:auto">\n  <tbody>\n    <tr>\n      <th colspan="2"></th>\n      <th style="text-align:left">Dato</th>\n      <th style="text-align:left">Beskrivelse</th>\n      <th style="text-align:right">Bel\xF8b</th>\n      <th style="text-align:right">Saldo</th>\n    </tr>\n    ',"\n  </tbody>\n</table>"])),t.map(e=>html(ke||(ke=r(["\n    <tr>\n      <td>","</td>\n      <td>","</td>\n      <td>","</td>\n      <td>",'</td>\n      <td style="text-align:right">','</td>\n      <td style="text-align:right">',"</td>\n    </tr>"])),e.itemid>0?html(fe||(fe=r(['<a href="#" @click|prevent=',' class="link-primary">',"</a>"])),()=>dt(e.itemid),k("edit")):null,e.itemid>0?html(ve||(ve=r(['<a href="#" @click|prevent=',' class="link-danger">',"</a>"])),()=>Ee(e.itemid),k("trash")):null,Oe(e.dato),e.beskriv,M(e.bel\u00F8b),nt(e.balance))))}var we,$e;function Ze(){return[D,{title:"Budget er slettet fra skyen",contentBody:html(we||(we=r(['<p>Dit budget eksisterer lige nu kun i din browser, og er helt v\xE6k n\xE5r du lukker browser-vinduet/fanen.</p>\n    <p>Hvis du slettede ved en fejl, kan du gemme budgettet igen ved at klikke p\xE5 "Gem i skyen" knappen.\n    Budgettet vil s\xE5 blive gemt igen p\xE5 en ny adresse.</p>']))),contentFooter:html($e||($e=r(['<button type="button" class="btn btn-primary" data-bs-dismiss="modal" style="min-width:6rem">OK</button>'])))},t=>Se=t]}var Me,xe;function tn(){return[D,{title:"Lav Kopi",contentBody:html(Me||(Me=r(["<p>Du arbejder nu i en kopi af dit tidligere budget.</p>\n    <p>Hvis du ikke fik gemt adressen p\xE5 dit originale budget, kan du g\xE5 tilbage til det med din browsers tilbage-knap.</p>"]))),contentFooter:html(xe||(xe=r(['<button type="button" class="btn btn-primary" data-bs-dismiss="modal" style="min-width:6rem">OK</button>'])))},t=>Le=t]}var Ce,Be;function en(){return[D,{title:"Nyt budget",contentBody:html(Ce||(Ce=r(["<p>Du arbejder nu i et nyt budget.</p>\n      <p>Hvis du ikke fik gemt adressen p\xE5 dit tidligere budget, kan du g\xE5 tilbage til det med din browsers tilbage-knap.</p>"]))),contentFooter:html(Be||(Be=r(['<button type="button" class="btn btn-primary" data-bs-dismiss="modal" style="min-width:6rem">OK</button>'])))},t=>je=t]}var De,Ie;function nn(){return[D,{title:"Dit budget er nu gemt i skyen",contentBody:html(De||(De=r(['\n    <p>\n      Du kan \xE5bne dette budget igen senere ved at lave et bogm\xE6rke i din browser nu, og s\xE5 \xE5bne bogm\xE6rket senere.<br />\n      Eller du kan kopiere adressen (fra browserens adresse-felt) og gemme den et sikkert sted.\n    </p>\n    <p>\n      Du kan ogs\xE5 dele dit budget med andre (f.eks. bank-r\xE5dgiver eller revisor) ved at sende dem adressen.\n      Bem\xE6rk dog at dem du deler med ogs\xE5 vil kunne \xE6ndre og/eller slette budgettet.\n      Overvej derfor at sende dem en kopi (brug "Lav kopi" funktionen, gem, og send dem s\xE5 den nye adresse).\n    </p>']))),contentFooter:html(Ie||(Ie=r(['<button type="button" class="btn btn-primary" data-bs-dismiss="modal" style="min-width:6rem">OK</button>'])))},t=>Fe=t]}var rt=Katla.app("#app",We);window.addEventListener("beforeunload",function(t){f!==null&&A!==z()&&(t.returnValue="Dine \xE6ndringer er ikke gemt. Vil du stadig lukke browser-vinduet/tabben?")});window.addEventListener("hashchange",Ne,!1);Ne();})();
